@{
    ViewBag.Title = "SHA-256 Encryption";
    Layout = "_Layout";
}

<div class="container mt-5 cyber-theme">
    <div class="row justify-content-center mb-4">
        <div class="col-md-8">
            <div class="btn-group w-100" role="group">
                <a asp-controller="SHA256" asp-action="Index" class="btn btn-success cyber-button active">
                    <i class="fas fa-lock"></i> ENCRYPT
                </a>
                <a asp-controller="SHA256" asp-action="Decrypt" class="btn btn-success cyber-button">
                    <i class="fas fa-unlock"></i> DECRYPT
                </a>
            </div>
        </div>
    </div>

    <h2 class="mb-4 text-center cyber-title">SHA-256 ENCRYPTION</h2>
    
    <div class="row">
        <div class="col-md-12">
            <div class="form-group">
                <label for="inputText" class="form-label">Metin Girdisi:</label>
                <textarea id="inputText" class="form-control cyber-input" rows="5" placeholder="Şifrelenecek metni girin..."></textarea>
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-12">
            <button id="encryptButton" class="btn btn-success cyber-button">
                <i class="fas fa-lock"></i> Metni Şifrele
            </button>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="form-group">
                <label for="outputText" class="form-label">Şifrelenmiş Çıktı:</label>
                <textarea id="outputText" class="form-control cyber-output" rows="5" readonly></textarea>
            </div>
        </div>
    </div>

    <hr class="my-4">

    <div class="row">
        <div class="col-md-12">
            <div class="form-group">
                <label for="fileInput" class="form-label">Dosya Girdisi:</label>
                <input type="file" id="fileInput" class="form-control cyber-input">
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-12">
            <button id="hashFileButton" class="btn btn-success cyber-button">
                <i class="fas fa-file-alt"></i> Dosyayı Hashle
            </button>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="form-group">
                <label for="fileOutput" class="form-label">Dosya Hash Çıktısı:</label>
                <textarea id="fileOutput" class="form-control cyber-output" rows="5" readonly></textarea>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('#encryptButton').on('click', function() {
                const inputText = $('#inputText').val();
                
                if (!inputText) {
                    alert('Şifrelemek için metin girin!');
                    return;
                }

                $.ajax({
                    url: '@Url.Action("Encrypt", "SHA256")',
                    type: 'POST',
                    data: { input: inputText },
                    success: function(response) {
                        if (response.success) {
                            $('#outputText').val(response.result);
                        } else {
                            alert(response.message || 'Bir hata oluştu!');
                        }
                    },
                    error: function() {
                        alert('İşlem sırasında bir hata oluştu!');
                    }
                });
            });

            $('#hashFileButton').on('click', function() {
                const fileInput = $('#fileInput')[0];
                if (!fileInput.files || fileInput.files.length === 0) {
                    alert('Lütfen bir dosya seçin!');
                    return;
                }

                const formData = new FormData();
                formData.append('file', fileInput.files[0]);

                $.ajax({
                    url: '@Url.Action("HashFile", "SHA256")',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function(response) {
                        if (response.success) {
                            $('#fileOutput').val(response.result);
                        } else {
                            alert(response.message || 'Bir hata oluştu!');
                        }
                    },
                    error: function() {
                        alert('İşlem sırasında bir hata oluştu!');
                    }
                });
            });
        });
    </script>
}
